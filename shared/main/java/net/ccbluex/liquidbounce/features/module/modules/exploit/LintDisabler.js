import java.util.ArrayList;
import net.ccbluex.liquidbounce.event.EventTarget;
import net.ccbluex.liquidbounce.event.PacketEvent;
import net.ccbluex.liquidbounce.event.UpdateEvent;
import net.ccbluex.liquidbounce.features.module.Module;
import net.ccbluex.liquidbounce.features.module.ModuleCategory;
import net.ccbluex.liquidbounce.features.module.ModuleInfo;
import net.ccbluex.liquidbounce.features.module.modules.exploit.Disabler;
import net.ccbluex.liquidbounce.utils.MovementUtils;
import net.ccbluex.liquidbounce.utils.misc.RandomUtils;
import net.ccbluex.liquidbounce.utils.timer.MSTimer;
import net.ccbluex.liquidbounce.value.ListValue;
import net.minecraft.entity.player.PlayerCapabilities;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.C00PacketKeepAlive;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.play.client.C0CPacketInput;
import net.minecraft.network.play.client.C0FPacketConfirmTransaction;
import net.minecraft.network.play.client.C13PacketPlayerAbilities;
import org.jetbrains.annotations.Nullable;

@ModuleInfo(name = "Disabler", description = "Fuck hypixel in the asshole", category = ModuleCategory.EXPLOIT)
public class Disabler extends Module {
  public static ListValue mode = new ListValue("Mode", new String[] { "Hypixel", "Ghostly", "OnlyMC", "Verus", "Faithful", "EcuaCraft", "Viper", "Verus Combat" }, "Hypixel");
  
  public ArrayList<C0FPacketConfirmTransaction> C0Fs = new ArrayList<>();
  
  public ArrayList<C00PacketKeepAlive> c0S = new ArrayList<>();
  
  public ArrayList<C0FPacketConfirmTransaction> c0F = new ArrayList<>();
  
  public MSTimer co = new MSTimer();
  
  public MSTimer c0ftimer = new MSTimer();
  
  int currentC0F = 0;
  
  @Nullable
  public String getTag() {
    return (String)mode.get();
  }
  
  public void onEnable() {
    this.currentC0F = 0;
    this.C0Fs.clear();
    this.c0ftimer.reset();
    this.co.reset();
  }
  
  @EventTarget
  public void onUpdate(UpdateEvent event) {
    PlayerCapabilities playerCapabilities;
    switch ((String)mode.get()) {
      case "OnlyMC":
      case "EcuaCraft":
        if (mc.field_71439_g.field_70173_aa % 240 == 0 && !this.C0Fs.isEmpty()) {
          for (C0FPacketConfirmTransaction packet : this.C0Fs)
            addToSendQueueNoEvent((Packet)packet); 
          this.C0Fs.clear();
        } 
        break;
      case "Hypixel":
        if (mc.field_71439_g.field_70173_aa > 5 && this.C0Fs.size() > 0) {
          this.C0Fs.clear();
          return;
        } 
        if (this.c0ftimer.hasTimePassed((long)(5000.0F + RandomUtils.nextFloat(1000.0F, 4000.0F)))) {
          for (C0FPacketConfirmTransaction p : this.c0F)
            addToSendQueueNoEvent((Packet)p); 
          for (C00PacketKeepAlive p : this.c0S)
            addToSendQueueNoEvent((Packet)p); 
          this.c0ftimer.reset();
          this.c0F.clear();
          this.c0S.clear();
        } 
        playerCapabilities = new PlayerCapabilities();
        playerCapabilities.field_75101_c = true;
        playerCapabilities.field_75100_b = true;
        playerCapabilities.field_75098_d = true;
        playerCapabilities.func_82877_b((float)RandomUtils.nextDouble(8.54D, 8.6D));
        playerCapabilities.func_75092_a((float)RandomUtils.nextDouble(8.6D, 8.7D));
        addToSendQueueNoEvent((Packet)new C13PacketPlayerAbilities(playerCapabilities));
        break;
    } 
  }
  
  @EventTarget
  public void onPacket(PacketEvent e) {
    Packet packet = e.getPacket();
    switch ((String)mode.get()) {
      case "Hypixel":
        if (e.getPacket() instanceof C0FPacketConfirmTransaction) {
          C0FPacketConfirmTransaction e43 = (C0FPacketConfirmTransaction)e.getPacket();
          if (e43.func_149533_d() < 13) {
            this.c0F.add(new C0FPacketConfirmTransaction(e43.func_149532_c(), e43.func_149533_d(), false));
            e.cancelEvent();
          } 
          break;
        } 
        if (e.getPacket() instanceof C00PacketKeepAlive) {
          this.c0S.add((C00PacketKeepAlive)e.getPacket());
          e.cancelEvent();
        } 
        break;
      case "Verus Combat":
        if (packet instanceof C00PacketKeepAlive)
          addToSendQueueNoEvent((Packet)new C00PacketKeepAlive(((C00PacketKeepAlive)packet).func_149460_c() - RandomUtils.nextInt(1000, 2147483647))); 
        break;
      case "EcuaCraft":
        if (packet instanceof C00PacketKeepAlive) {
          addToSendQueueNoEvent((Packet)new C00PacketKeepAlive(((C00PacketKeepAlive)packet).func_149460_c() - RandomUtils.nextInt(1000, 2147483647)));
          break;
        } 
        if (packet instanceof C0FPacketConfirmTransaction) {
          this.C0Fs.add((C0FPacketConfirmTransaction)packet);
          e.cancelEvent();
          break;
        } 
        if (packet instanceof C03PacketPlayer) {
          addToSendQueueNoEvent((Packet)new C0CPacketInput());
          if (MovementUtils.istooHigh(0.43D))
            ((C03PacketPlayer)packet).field_149477_b += 0.42D; 
        } 
        break;
      case "Viper":
        if (packet instanceof C03PacketPlayer) {
          if (this.c0ftimer.hasTimePassed(1009L)) {
            this.c0ftimer.reset();
            for (int i = 0; i < 10; i++) {
              double y = (i > 2 && i < 8) ? 11.0D : 4.3947E-68D;
              addToSendQueueNoEvent((Packet)new C03PacketPlayer.C04PacketPlayerPosition(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u - y, mc.field_71439_g.field_70161_v, true));
            } 
            break;
          } 
          addToSendQueueNoEvent((Packet)new C0CPacketInput());
          ((C03PacketPlayer)packet).field_149477_b += 0.42D;
        } 
        break;
      case "Verus":
        if (packet instanceof C0FPacketConfirmTransaction) {
          C0FPacketConfirmTransaction c0f = (C0FPacketConfirmTransaction)packet;
          this.C0Fs.add(c0f);
          e.cancelEvent();
        } else if (packet instanceof C03PacketPlayer) {
          C03PacketPlayer packetPlayer = (C03PacketPlayer)packet;
          if (mc.field_71439_g.field_70173_aa % 50 == 0) {
            packetPlayer.field_149477_b = -1.0D;
            packetPlayer.field_149474_g = false;
          } 
        } else if (packet instanceof C00PacketKeepAlive) {
          addToSendQueueNoEvent((Packet)new C00PacketKeepAlive(((C00PacketKeepAlive)packet).func_149460_c() - RandomUtils.nextInt(1337, 2147483647)));
        } 
        if (mc.field_71439_g.field_70173_aa % 50 == 0 && !this.C0Fs.isEmpty()) {
          for (Packet<?> packetConfirmTransaction : this.C0Fs)
            addToSendQueueNoEvent(packetConfirmTransaction); 
          this.C0Fs.clear();
        } 
        break;
      case "Ghostly":
        if (packet instanceof C0FPacketConfirmTransaction) {
          e.cancelEvent();
          break;
        } 
        if (packet instanceof C03PacketPlayer)
          addToSendQueueNoEvent((Packet)new C0CPacketInput()); 
        break;
      case "Faithful":
        if (packet instanceof C03PacketPlayer) {
          addToSendQueueNoEvent((Packet)new C0CPacketInput(0.0F, 0.0F, false, false));
          e.cancelEvent();
          break;
        } 
        if (packet instanceof C0FPacketConfirmTransaction) {
          addToSendQueueNoEvent((Packet)new C0FPacketConfirmTransaction(((C0FPacketConfirmTransaction)packet).func_149532_c(), (short)0, true));
          e.cancelEvent();
          break;
        } 
        if (packet instanceof C00PacketKeepAlive) {
          addToSendQueueNoEvent((Packet)new C00PacketKeepAlive(((C00PacketKeepAlive)packet).func_149460_c() - 1337));
          e.cancelEvent();
        } 
        break;
      case "OnlyMC":
        if (packet instanceof C0FPacketConfirmTransaction) {
          this.C0Fs.add((C0FPacketConfirmTransaction)packet);
          e.cancelEvent();
          break;
        } 
        if (packet instanceof C00PacketKeepAlive) {
          addToSendQueueNoEvent((Packet)new C00PacketKeepAlive(((C00PacketKeepAlive)packet).func_149460_c() - 1337));
          e.cancelEvent();
          break;
        } 
        if (packet instanceof C03PacketPlayer) {
          addToSendQueueNoEvent((Packet)new C0CPacketInput());
          if (!MovementUtils.istooHigh(0.4205D))
            ((C03PacketPlayer)packet).field_149477_b += 0.42D; 
        } 
        break;
    } 
  }
  
  public void addToSendQueueNoEvent(Packet p) {
    mc.func_147114_u().func_147298_b().func_179290_a(p);
  }
}
